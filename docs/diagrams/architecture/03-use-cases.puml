@startuml Use Cases
skinparam shadowing false
skinparam ActorBackgroundColor #E6F3FF
skinparam ActorBorderColor #146EB4
skinparam UsecaseBackgroundColor white
skinparam UsecaseBorderColor #232F3E
skinparam UsecaseBorderThickness 2
skinparam ArrowThickness 2

title Use Cases - Project Cost Control System\nRole-Based Access Control (RBAC)

' Actors on the left
actor "Admin" as admin #FFE6CC
actor "Project\nManager" as pm #E6F3FF
actor "Viewer" as viewer #F5F5F5

' Main system boundary
rectangle "Project Cost Control System" {
    
    ' Row 1: Authentication & Projects
    package "Authentication" #FFE6CC {
        usecase "UC1: Login Email/Password" as UC1
        usecase "UC2: Login Microsoft SSO" as UC2
        usecase "UC3: Setup MFA" as UC3
        usecase "UC4: Logout" as UC4
    }
    
    package "Project Management" #E6F3FF {
        usecase "UC5: Create Project" as UC5
        usecase "UC6: Edit Project" as UC6
        usecase "UC7: Delete Project" as UC7
        usecase "UC8: View Projects" as UC8
    }
    
    ' Row 2: Budget & Employees
    package "Budget Management" #E6FFE6 {
        usecase "UC9: Create Budget" as UC9
        usecase "UC10: Edit Budget" as UC10
        usecase "UC11: View Budget" as UC11
        usecase "UC12: Import Budget" as UC12
    }
    
    package "Employee Management" #FFF0E6 {
        usecase "UC13: Add Employee" as UC13
        usecase "UC14: Edit Employee" as UC14
        usecase "UC15: View Employees" as UC15
    }
    
    ' Row 3: Time & Actuals
    package "Time Entry" #FFFFE6 {
        usecase "UC16: Enter Time" as UC16
        usecase "UC17: Edit Time" as UC17
        usecase "UC18: View Time" as UC18
        usecase "UC19: Import Time" as UC19
    }
    
    package "Actuals Tracking" #FFE6F0 {
        usecase "UC20: Enter Actuals" as UC20
        usecase "UC21: Edit Actuals" as UC21
        usecase "UC22: View Actuals" as UC22
        usecase "UC23: Calculate Actuals" as UC23
    }
    
    ' Row 4: Projections & Reports
    package "Projections" #F0E6FF {
        usecase "UC24: Create Projection" as UC24
        usecase "UC25: Edit Projection" as UC25
        usecase "UC26: View Projections" as UC26
        usecase "UC27: Compare Projections" as UC27
    }
    
    package "Reporting" #E6FFFF {
        usecase "UC28: View Dashboard" as UC28
        usecase "UC29: Budget vs Actual" as UC29
        usecase "UC30: GP Analysis" as UC30
        usecase "UC31: Export Reports" as UC31
    }
    
    ' Row 5: Administration
    package "Administration" #FFE6E6 {
        usecase "UC32: Manage Users" as UC32
        usecase "UC33: Manage Cost Codes" as UC33
        usecase "UC34: Manage Labor Rates" as UC34
        usecase "UC35: View Audit Logs" as UC35
    }
}

' Admin - Full Access (connect to key use cases only)
admin --> UC1
admin --> UC5
admin --> UC7
admin --> UC9
admin --> UC12
admin --> UC13
admin --> UC16
admin --> UC19
admin --> UC20
admin --> UC23
admin --> UC24
admin --> UC28
admin --> UC32

' Project Manager - Limited Access
pm --> UC1
pm --> UC5
pm --> UC6
pm --> UC8
pm --> UC9
pm --> UC10
pm --> UC11
pm --> UC13
pm --> UC14
pm --> UC15
pm --> UC16
pm --> UC17
pm --> UC18
pm --> UC20
pm --> UC21
pm --> UC22
pm --> UC24
pm --> UC25
pm --> UC26
pm --> UC28
pm --> UC29
pm --> UC30

' Viewer - Read Only
viewer --> UC1
viewer --> UC8
viewer --> UC11
viewer --> UC15
viewer --> UC18
viewer --> UC22
viewer --> UC26
viewer --> UC28
viewer --> UC29
viewer --> UC30

' Use case relationships
UC12 ..> UC9 : includes
UC19 ..> UC16 : includes
UC23 ..> UC18 : includes
UC23 ..> UC20 : includes
UC29 ..> UC11 : includes
UC29 ..> UC22 : includes
UC30 ..> UC26 : includes

note top of UC3
  MFA required
  for Admin users
end note

note top of UC32
  Admin only:
  User management
  Role assignment
end note

note top of UC19
  Future: Import
  from Spectrum ERP
end note

legend right
  <b>User Roles & Permissions</b>
  |= Role |= Access Level |
  |<#FFE6CC> Admin | Full system access (all use cases) |
  |<#E6F3FF> Project Manager | Assigned projects only |
  |<#F5F5F5> Viewer | Read-only access |
  
  <b>Feature Modules:</b>
  |<#FFE6CC>| Authentication |
  |<#E6F3FF>| Project Management |
  |<#E6FFE6>| Budget Management |
  |<#FFF0E6>| Employee Management |
  |<#FFFFE6>| Time Entry |
  |<#FFE6F0>| Actuals Tracking |
  |<#F0E6FF>| Projections |
  |<#E6FFFF>| Reporting |
  |<#FFE6E6>| Administration |
  
  <b>Total Use Cases:</b> 35
endlegend

@enduml
